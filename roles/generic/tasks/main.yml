---
- name: Update Yum Packages - RedHat
  yum:
    update_cache: yes
    name: "*"
    state: latest
  when: ansible_os_family | lower == 'redhat'

- name: Update Apt Packages - Debian
  apt:
    upgrade: dist
    update_cache: yes
  when: ansible_os_family | lower == 'debian'

- name: Install Generic Pre Reqs - RedHat
  yum:
    name: "{{ item }}"
    state: latest
  with_items:
    - "{{ generic_packages }}"
  when: ansible_os_family | lower == 'redhat'

- name: Install Generic Pre Reqs - Debian
  apt:
    name: "{{ item }}"
    state: latest
  with_items:
    - "{{ generic_packages }}"
  when: ansible_os_family | lower == 'debian'

- name: Install Generic Pre Reqs - RedHat
  yum:
    name: "{{ item }}"
    state: latest
  with_items:
    - "{{ redhat_packages }}"
  when: ansible_os_family | lower == 'redhat'

- name: Install Generic Pre Reqs - RedHat6
  yum:
    name: "{{ item }}"
    state: latest
  with_items:
    - "{{ redhat_packages_6 }}"
  when: ansible_os_family | lower == 'redhat' and ansible_distribution_version <= '6.8'

- name: Remove conflicting Packages - RedHat
  yum:
    name: "{{ item }}"
    state: absent
  with_items:
    - "{{ redhat_packages_conflicting_remove }}"
  when: ansible_os_family | lower == 'redhat'

- name: Install Generic Packages - Debian
  apt:
    name: "{{ item }}"
    state: latest
  with_items:
    - "{{ debian_packages }}"
  when: ansible_os_family | lower == 'debian'

- name: Fix bash_completion grub
  copy:
    src: grub
    dest: /etc/bash_completion.d/grub
    owner: root
    group: root
    mode: 0644

- name: Fix bash_completion desktop-file-validate
  copy:
    src: grub
    dest: /etc/bash_completion.d/desktop-file-validate
    owner: root
    group: root
    mode: 0644

- name: Fix bash_completion insserv
  copy:
    src: grub
    dest: /etc/bash_completion.d/insserv
    owner: root
    group: root
    mode: 0644

- debug: msg="Generic Package installation Complete"
